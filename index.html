    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>POT Buyback Portal</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at top, #223354 0, #020617 40%, #020412 100%);
      color: #ffffff;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px 12px;
    }

    .card {
      width: 100%;
      max-width: 460px;
      background: rgba(15, 23, 42, 0.96);
      border-radius: 24px;
      box-shadow: 0 22px 70px rgba(0, 0, 0, 0.75);
      padding: 26px 24px 28px;
      border: 1px solid rgba(148, 163, 184, 0.25);
    }

    .header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 16px;
    }

    .logo {
      width: 72px;
      height: 72px;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 10px 28px rgba(0, 0, 0, 0.65);
      flex-shrink: 0;
      background: #020617;
    }

    .logo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .title-block h1 {
      margin: 0;
      font-size: 22px;
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    .title-block .subtitle {
      margin-top: 4px;
      font-size: 13px;
      color: #cbd5f5;
    }

    .title-block .tagline {
      margin-top: 2px;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #94a3b8;
    }

    .status-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
      font-size: 12px;
      color: #cbd5f5;
    }

    .status-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      background: rgba(22, 163, 74, 0.12);
      border-radius: 999px;
      border: 1px solid rgba(22, 163, 74, 0.65);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.25);
    }

    .network-pill {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      font-size: 11px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #e2e8f0;
      background: radial-gradient(circle at top left, #1e293b, #020617);
    }

    .wallet-box {
      border-radius: 16px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: radial-gradient(circle at top left, #111827, #020617);
      padding: 14px 14px 16px;
      margin-bottom: 16px;
    }

    .wallet-label {
      font-size: 12px;
      color: #94a3b8;
      margin-bottom: 6px;
    }

    .wallet-address {
      font-size: 13px;
      margin-bottom: 10px;
      color: #e2e8f0;
    }

    .wallet-buttons {
      display: flex;
      gap: 8px;
    }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 10px 16px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.16s ease-out;
    }

    .btn-primary {
      flex: 1;
      background: linear-gradient(135deg, #16a34a, #22c55e);
      color: #ffffff;
      box-shadow: 0 14px 30px rgba(22, 163, 74, 0.55);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 18px 40px rgba(22, 163, 74, 0.8);
    }

    .btn-outline {
      min-width: 120px;
      background: transparent;
      color: #e2e8f0;
      border: 1px solid rgba(148, 163, 184, 0.7);
    }

    .btn-outline:hover {
      background: rgba(15, 23, 42, 0.9);
    }

    .btn:disabled {
      opacity: 0.55;
      cursor: default;
      transform: none;
      box-shadow: none;
    }

    .section-label-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 6px;
      margin-top: 2px;
    }

    .section-label {
      font-size: 13px;
      color: #e2e8f0;
    }

    .balance-label {
      font-size: 12px;
      color: #94a3b8;
    }

    .input-row {
      display: flex;
      gap: 8px;
      margin-bottom: 14px;
    }

    .input-field {
      flex: 1;
      background: #020617;
      border-radius: 999px;
      border: 1px solid rgba(30, 64, 175, 0.85);
      padding: 10px 14px;
      color: #e5e7eb;
      font-size: 15px;
      outline: none;
    }

    .input-field:focus {
      border-color: #38bdf8;
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.65),
        0 0 0 8px rgba(56, 189, 248, 0.16);
    }

    .token-tag {
      min-width: 80px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: radial-gradient(circle at top left, #1e293b, #020617);
      color: #e2e8f0;
      font-size: 13px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
    }

    .info-box {
      border-radius: 14px;
      background: rgba(15, 23, 42, 0.92);
      border: 1px solid rgba(51, 65, 85, 0.85);
      padding: 10px 12px 10px;
      margin-bottom: 16px;
      font-size: 12px;
      color: #cbd5f5;
    }

    .info-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 4px;
    }

    .info-label {
      color: #94a3b8;
    }

    .info-value {
      font-variant-numeric: tabular-nums;
    }

    .info-highlight {
      color: #22c55e;
      font-weight: 600;
    }

    .btn-sell {
      width: 100%;
      border-radius: 999px;
      border: none;
      padding: 12px 16px;
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: #ffffff;
      font-weight: 700;
      font-size: 15px;
      letter-spacing: 0.03em;
      text-transform: none;
      cursor: pointer;
      margin-top: 4px;
      transition: all 0.15s ease-out;
      box-shadow: 0 18px 45px rgba(22, 163, 74, 0.9);
    }

    .btn-sell:hover {
      transform: translateY(-1px);
      box-shadow: 0 22px 60px rgba(22, 163, 74, 1);
    }

    .btn-sell:disabled {
      opacity: 0.55;
      cursor: default;
      transform: none;
      box-shadow: none;
    }

    .status-message {
      margin-top: 10px;
      font-size: 12px;
      min-height: 18px;
    }

    .status-message.error {
      color: #f97373;
    }

    .status-message.success {
      color: #4ade80;
    }

    .status-message.note {
      color: #e5e7eb;
    }

    .footer {
      margin-top: 12px;
      font-size: 11px;
      color: #64748b;
      text-align: center;
    }

    .footer span {
      color: #e5e7eb;
    }

    @media (max-width: 480px) {
      .card {
        padding: 22px 18px 22px;
      }

      .title-block h1 {
        font-size: 19px;
      }

      .logo {
        width: 64px;
        height: 64px;
      }
    }
  </style>
</head>

<body>
  <div class="card">
    <div class="header">
      <div class="logo">
        <img
          src="https://raw.githubusercontent.com/pandafamily2025/BayBack.page/refs/heads/main/Screenshot_20251120_104806_Telegram.jpg"
          alt="POT Logo" />
      </div>
      <div class="title-block">
        <h1>POT Buyback Portal</h1>
        <div class="subtitle">Sell POT directly for USDT on BSC</div>
        <div class="tagline">Playtopia Organization Token (POT)</div>
      </div>
    </div>

    <div class="status-row">
      <div class="status-pill" id="connection-status">
        <span class="status-dot"></span>
        <span id="connection-label">Disconnected</span>
      </div>
      <div class="network-pill" id="network-label">
        Network: BNB Smart Chain
      </div>
    </div>

    <div class="wallet-box">
      <div class="wallet-label">Wallet</div>
      <div class="wallet-address" id="wallet-address">Not connected</div>
      <div class="wallet-buttons">
        <button class="btn btn-primary" id="connect-btn">Connect Wallet</button>
        <button class="btn btn-outline" id="disconnect-btn" disabled>
          Disconnect
        </button>
      </div>
    </div>

    <div class="section-label-row">
      <div class="section-label">Amount of POT to sell</div>
      <div class="balance-label" id="balance-label">Balance: – POT</div>
    </div>

    <div class="input-row">
      <input
        id="amount-input"
        class="input-field"
        type="number"
        min="0"
        step="0.000001"
        placeholder="e.g. 1000" />
      <div class="token-tag">POT</div>
    </div>

    <div class="info-box">
      <div class="info-row">
        <div class="info-label">Buyback Price:</div>
        <div class="info-value info-highlight" id="price-label">
          Loading...
        </div>
      </div>
      <div class="info-row">
        <div class="info-label">Estimated Receive:</div>
        <div class="info-value" id="estimated-label">– USDT</div>
      </div>
    </div>

    <button class="btn-sell" id="sell-btn" disabled>
      Sell POT for USDT
    </button>

    <div class="status-message note" id="status-message">
      Connect your wallet to start.
    </div>

    <div class="footer">
      Payout token: <span>BEP-20 USDT (0x55d3…7955)</span>
    </div>
  </div>

  <script>
    const BUYBACK_ADDRESS = "0x9652CC7355C759DB295E8bd5A21d4D707FC07085";
    const POT_ADDRESS = "0x66059443da552aAe6a032E3a84307E6BBbd3cd01";
    const USDT_ADDRESS = "0x55d398326f99059fF775485246999027B3197955";

    const BUYBACK_ABI = [
      {
        inputs: [
          { internalType: "address", name: "_token", type: "address" },
          { internalType: "address", name: "_usdt", type: "address" },
        ],
        stateMutability: "nonpayable",
        type: "constructor",
      },
      {
        inputs: [],
        name: "owner",
        outputs: [{ internalType: "address", name: "", type: "address" }],
        stateMutability: "view",
        type: "function",
      },
      {
        inputs: [],
        name: "price",
        outputs: [{ internalType: "uint256", name: "", type: "uint256" }],
        stateMutability: "view",
        type: "function",
      },
      {
        inputs: [{ internalType: "uint256", name: "amount", type: "uint256" }],
        name: "sellTokens",
        outputs: [],
        stateMutability: "nonpayable",
        type: "function",
      },
      {
        inputs: [
          { internalType: "uint256", name: "newPrice", type: "uint256" },
        ],
        name: "setPrice",
        outputs: [],
        stateMutability: "nonpayable",
        type: "function",
      },
      {
        inputs: [],
        name: "token",
        outputs: [
          { internalType: "contract IERC20", name: "", type: "address" },
        ],
        stateMutability: "view",
        type: "function",
      },
      {
        inputs: [],
        name: "usdt",
        outputs: [
          { internalType: "contract IERC20", name: "", type: "address" },
        ],
        stateMutability: "view",
        type: "function",
      },
      {
        inputs: [{ internalType: "uint256", name: "amount", type: "uint256" }],
        name: "withdrawTokens",
        outputs: [],
        stateMutability: "nonpayable",
        type: "function",
      },
      {
        inputs: [{ internalType: "uint256", name: "amount", type: "uint256" }],
        name: "withdrawUSDT",
        outputs: [],
        stateMutability: "nonpayable",
        type: "function",
      },
    ];

    const ERC20_ABI = [
      {
        constant: true,
        inputs: [{ name: "owner", type: "address" }],
        name: "balanceOf",
        outputs: [{ name: "balance", type: "uint256" }],
        type: "function",
      },
      {
        constant: true,
        inputs: [
          { name: "owner", type: "address" },
          { name: "spender", type: "address" },
        ],
        name: "allowance",
        outputs: [{ name: "remaining", type: "uint256" }],
        type: "function",
      },
      {
        constant: false,
        inputs: [
          { name: "spender", type: "address" },
          { name: "value", type: "uint256" },
        ],
        name: "approve",
        outputs: [{ name: "success", type: "bool" }],
        type: "function",
      },
      {
        constant: true,
        inputs: [],
        name: "decimals",
        outputs: [{ name: "", type: "uint8" }],
        type: "function",
      },
    ];

    const connectBtn = document.getElementById("connect-btn");
    const disconnectBtn = document.getElementById("disconnect-btn");
    const walletAddressEl = document.getElementById("wallet-address");
    const connectionLabel = document.getElementById("connection-label");
    const statusMessage = document.getElementById("status-message");
    const balanceLabel = document.getElementById("balance-label");
    const amountInput = document.getElementById("amount-input");
    const priceLabel = document.getElementById("price-label");
    const estimatedLabel = document.getElementById("estimated-label");
    const sellBtn = document.getElementById("sell-btn");

    let provider;
    let signer;
    let userAddress;
    let buybackContract;
    let potToken;
    let usdtToken;
    let potDecimals = 18;
    let currentPriceBN = null;

    function setStatus(message, type = "note") {
      statusMessage.textContent = message;
      statusMessage.className = "status-message " + type;
    }

    function shortenAddress(addr) {
      if (!addr) return "";
      return addr.slice(0, 6) + "..." + addr.slice(-4);
    }

    async function connectWallet() {
      try {
        if (!window.ethereum) {
          setStatus(
            "No wallet detected. Please install MetaMask or a Web3 wallet.",
            "error"
          );
          return;
        }

        provider = new ethers.providers.Web3Provider(window.ethereum);
        await provider.send("eth_requestAccounts", []);
        signer = provider.getSigner();
        userAddress = await signer.getAddress();

        const network = await provider.getNetwork();
        if (network.chainId !== 56) {
          setStatus(
            "Warning: You are not on BNB Smart Chain (chainId 56).",
            "error"
          );
        } else {
          setStatus("Wallet connected. Ready to sell POT.", "success");
        }

        walletAddressEl.textContent = userAddress;
        connectionLabel.textContent = "Connected";

        connectBtn.textContent = "Wallet Connected";
        connectBtn.disabled = true;
        disconnectBtn.disabled = false;
        sellBtn.disabled = false;

        buybackContract = new ethers.Contract(
          BUYBACK_ADDRESS,
          BUYBACK_ABI,
          signer
        );
        potToken = new ethers.Contract(POT_ADDRESS, ERC20_ABI, signer);
        usdtToken = new ethers.Contract(USDT_ADDRESS, ERC20_ABI, signer);

        try {
          potDecimals = await potToken.decimals();
        } catch (e) {
          potDecimals = 18;
        }

        await refreshPrice();
        await refreshBalance();
        updateEstimation();
      } catch (err) {
        console.error(err);
        setStatus("Failed to connect wallet.", "error");
      }
    }

    function disconnectWallet() {
      provider = undefined;
      signer = undefined;
      userAddress = undefined;
      buybackContract = undefined;
      potToken = undefined;
      usdtToken = undefined;

      walletAddressEl.textContent = "Not connected";
      connectionLabel.textContent = "Disconnected";

      connectBtn.textContent = "Connect Wallet";
      connectBtn.disabled = false;
      disconnectBtn.disabled = true;
      sellBtn.disabled = true;

      balanceLabel.textContent = "Balance: – POT";
      priceLabel.textContent = "Loading...";
      estimatedLabel.textContent = "– USDT";

      setStatus("Wallet disconnected.", "note");
    }

    async function refreshPrice() {
      if (!buybackContract) return;
      try {
        const priceBN = await buybackContract.price();
        currentPriceBN = priceBN;

        const priceStr = ethers.utils.formatUnits(priceBN, 18);
        const priceNum = parseFloat(priceStr);
        const pretty =
          priceNum >= 0.001 ? priceNum.toFixed(4) : priceNum.toFixed(6);

        priceLabel.textContent = `${pretty} USDT per POT`;
      } catch (err) {
        console.error(err);
        priceLabel.textContent = "Error loading price";
      }
    }

    async function refreshBalance() {
      if (!potToken || !userAddress) return;
      try {
        const balanceBN = await potToken.balanceOf(userAddress);
        const balanceStr = ethers.utils.formatUnits(balanceBN, potDecimals);
        const balanceNum = parseFloat(balanceStr);
        const pretty =
          balanceNum >= 1000 ? balanceNum.toFixed(2) : balanceNum.toFixed(4);
        balanceLabel.textContent = `Balance: ${pretty} POT`;
      } catch (err) {
        console.error(err);
        balanceLabel.textContent = "Balance: – POT";
      }
    }

    function updateEstimation() {
      if (!currentPriceBN) {
        estimatedLabel.textContent = "– USDT";
        return;
      }

      const raw = amountInput.value.trim();
      if (!raw || Number(raw) <= 0) {
        estimatedLabel.textContent = "– USDT";
        return;
      }

      try {
        const amountBN = ethers.utils.parseUnits(raw, potDecimals);
        const payoutBN = amountBN.mul(currentPriceBN).div(
          ethers.constants.WeiPerEther
        );
        const payoutStr = ethers.utils.formatUnits(payoutBN, 18);
        const payoutNum = parseFloat(payoutStr);
        const pretty =
          payoutNum >= 1 ? payoutNum.toFixed(4) : payoutNum.toFixed(6);
        estimatedLabel.textContent = `${pretty} USDT`;
      } catch (err) {
        estimatedLabel.textContent = "– USDT";
      }
    }

    async function handleSell() {
      if (!buybackContract || !potToken || !userAddress) {
        setStatus("Connect your wallet first.", "error");
        return;
      }

      const raw = amountInput.value.trim();
      if (!raw || Number(raw) <= 0) {
        setStatus("Enter a valid POT amount.", "error");
        return;
      }

      try {
        const amountBN = ethers.utils.parseUnits(raw, potDecimals);

        setStatus("Checking allowance...", "note");
        sellBtn.disabled = true;

        const allowance = await potToken.allowance(
          userAddress,
          BUYBACK_ADDRESS
        );

        if (allowance.lt(amountBN)) {
          setStatus("Approving POT for the buyback contract...", "note");
          const approveTx = await potToken.approve(
            BUYBACK_ADDRESS,
            amountBN
          );
          await approveTx.wait();
        }

        setStatus("Sending sell transaction...", "note");
        const tx = await buybackContract.sellTokens(amountBN);
        await tx.wait();

        setStatus("Sell completed successfully ✅", "success");
        amountInput.value = "";
        await refreshBalance();
        updateEstimation();
      } catch (err) {
        console.error(err);
        let msg = "Transaction failed.";
        if (err && err.message) {
          msg = err.message.split("(")[0].trim();
        }
        setStatus(msg, "error");
      } finally {
        sellBtn.disabled = !userAddress;
      }
    }

    connectBtn.addEventListener("click", connectWallet);
    disconnectBtn.addEventListener("click", disconnectWallet);
    sellBtn.addEventListener("click", handleSell);
    amountInput.addEventListener("input", updateEstimation);

    if (window.ethereum) {
      window.ethereum.on("accountsChanged", (accounts) => {
        if (!accounts || accounts.length === 0) {
          disconnectWallet();
        } else {
          connectWallet();
        }
      });

      window.ethereum.on("chainChanged", () => {
        window.location.reload();
      });
    }
  </script>
</body>
</html>
  <!-- redeploy -->
